{{left_sidebar_enabled,right_sidebar_enabled=False,('message' in globals())}}
{{extend 'layout.html'}}

<!DOCTYPE html>

<!-- Dibujos vectoriales SVG -->
<html>
    <head>
		<svg
		   xmlns:dc="http://purl.org/dc/elements/1.1/"
		   xmlns:cc="http://creativecommons.org/ns#"
		   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
		   xmlns:svg="http://www.w3.org/2000/svg"
		   xmlns="http://www.w3.org/2000/svg"
		   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
		   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
		   width="611.09003"
		   height="496.35999"
		   id="svg2"
		   version="1.1"
		   inkscape:version="0.48.4 r9939"
		   sodipodi:docname="drawing-1.svg">
		   <defs
			  id="defs4" />
		   <sodipodi:namedview
			  id="base"
			  pagecolor="#ffffff"
			  bordercolor="#666666"
			  borderopacity="1.0"
			  inkscape:pageopacity="0.0"
	 		  inkscape:pageshadow="2"
			  inkscape:zoom="0.49497475"
			  inkscape:cx="440.90097"
			  inkscape:cy="207.93088"
			  inkscape:document-units="px"
			  inkscape:current-layer="g3055"
			  showgrid="false"
			  inkscape:window-width="1364"
			  inkscape:window-height="718"
			  inkscape:window-x="0"
			  inkscape:window-y="0"
			  inkscape:window-maximized="1" />
		   <metadata
			  id="metadata7">
		   <rdf:RDF>
		      <cc:Work
				 rdf:about="">
			  <dc:format>image/svg+xml</dc:format>
			  <dc:type
				 rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
			  <dc:title />
			  </cc:Work>
			  </rdf:RDF>
		   </metadata>
		   <g
			 inkscape:label="Layer 1"
			 inkscape:groupmode="layer"
			 id="layer1"
			 transform="translate(0,-555.99425)">
			<g
			   id="g3055"
			   transform="matrix(1.327286,0,0,1.2518851,-4.4538002,196.49635)">
			  <g
				 transform="matrix(4.4917684,0,0,3.8924496,7.9421827,290.89629)"
				 id="casa_completa">
				<path
				   d="M 91.834836,29.000704 V 7.6693 c 0,-0.9279394 -0.870368,-1.6790217 -1.942785,-1.6790217 H 69.307598 c -1.072418,0 -1.942786,0.7510823 -1.942786,1.6790217 v 3.970325 L 51.65675,0.49316322 c -0.718831,-0.50818375 -1.748507,-0.50818375 -2.466042,0 L 0.93581697,34.731763 C 0.3024697,35.18174 0.06285909,35.927225 0.34003002,36.595476 0.61590534,37.263727 1.3476881,37.709227 2.168838,37.709227 h 1.6267588 v 60.076498 c 0,0.927938 0.8703677,1.67902 1.9427846,1.67902 H 95.109072 c 1.072425,0 1.942786,-0.751082 1.942786,-1.67902 V 37.708108 h 1.626761 c 0.821149,0 1.552931,-0.445501 1.828801,-1.113751 0.27718,-0.667132 0.0376,-1.413736 -0.595782,-1.863714 L 91.834836,29.000704 z M 71.250383,9.3483207 H 87.949266 V 26.24487 L 71.250383,14.395458 V 9.3483207 z M 50.423729,3.9631404 93.250478,34.350065 H 7.5969792 L 50.423729,3.9631404 z M 61.247631,96.106703 H 39.599826 v -36.64072 h 21.6491 v 36.64072 z m 31.91866,0 H 65.1332 V 57.786962 c 0,-0.927939 -0.870367,-1.679021 -1.942784,-1.679021 H 37.657042 c -1.072417,0 -1.942785,0.751082 -1.942785,1.679021 V 96.106703 H 7.681166 V 37.708108 h 85.485125 v 58.398595 z"
				   id="casa"
				   inkscape:connector-curvature="0"
				   style="fill:#000000" />
				<rect
				   style="fill:#aa4400;fill-opacity:1;stroke:#000000;stroke-opacity:1"
				   id="puerta"
				   width="23"
				   height="36.864407"
				   x="38.983051"
				   y="59.322033" />
				<g
				   id="bombilla"
				   transform="matrix(0.22365778,0,0,0.26445843,11.090605,44.250944)">
				  <path
					 id="borde"
					 d="M 72.25,16.551 C 66.279,10.582 58.34,7.294 49.896,7.294 c -8.445,0 -16.384,3.288 -22.354,9.258 -5.971,5.971 -9.259,13.91 -9.258,22.354 0,8.443 3.289,16.38 9.26,22.351 l 7.37,7.371 v 19.435 c 0,3.987 2.966,5.802 5.722,5.802 0.069,0 0.127,-10e-4 0.155,-0.003 H 58.64 l 0.117,0.002 c 0.625,0 1.854,-0.109 3.072,-0.835 1.002,-0.599 2.686,-2.054 2.686,-5.072 V 68.991 l 7.733,-7.734 C 84.572,48.932 84.572,28.877 72.25,16.551 z M 31.911,56.89 C 27.106,52.086 24.46,45.7 24.459,38.905 c 0,-6.794 2.645,-13.182 7.449,-17.986 4.804,-4.803 11.192,-7.449 17.987,-7.449 6.795,0 13.182,2.645 17.988,7.448 9.915,9.918 9.914,26.055 -0.002,35.972 l -9.543,9.543 v 19.98 c 0,1.065 -0.719,1.246 -1.107,1.272 L 42.263,87.67 42.209,87.673 c -0.009,0.001 -0.037,0.003 -0.077,0.003 -0.691,0 -1.042,-0.39 -1.042,-1.159 V 66.072 L 31.911,56.89 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="casquillo1"
					 d="m 54.567,70.26 h -9.904 c -1.135,0 -2.055,-0.919 -2.055,-2.054 0,-1.135 0.92,-2.055 2.055,-2.055 h 9.904 c 1.134,0 2.055,0.92 2.055,2.055 0,1.135 -0.921,2.054 -2.055,2.054 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="casquillo2"
					 d="m 54.567,77.724 h -9.904 c -1.135,0 -2.055,-0.921 -2.055,-2.055 0,-1.136 0.92,-2.055 2.055,-2.055 h 9.904 c 1.134,0 2.055,0.919 2.055,2.055 0,1.134 -0.921,2.055 -2.055,2.055 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="casquillo3"
					 d="m 54.567,85.184 h -9.904 c -1.135,0 -2.055,-0.921 -2.055,-2.056 0,-1.134 0.92,-2.054 2.055,-2.054 h 9.904 c 1.134,0 2.055,0.92 2.055,2.054 0,1.135 -0.921,2.056 -2.055,2.056 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="rayo1"
					 d="m 12.845,22.263 c -0.436,0 -0.877,-0.111 -1.281,-0.345 L 2.986,16.966 c -1.229,-0.71 -1.649,-2.28 -0.94,-3.509 0.709,-1.229 2.281,-1.65 3.508,-0.94 l 8.578,4.953 c 1.229,0.71 1.649,2.28 0.94,3.509 -0.475,0.823 -1.339,1.284 -2.227,1.284 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="rayo2"
					 d="M 12.473,39.583 H 2.568 C 1.15,39.583 0,38.434 0,37.015 0,35.597 1.15,34.447 2.568,34.447 h 9.904 c 1.418,0 2.568,1.15 2.568,2.568 0.001,1.419 -1.149,2.568 -2.567,2.568 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="rayo5"
					 d="m 97.184,39.227 h -9.905 c -1.418,0 -2.567,-1.15 -2.567,-2.569 0,-1.418 1.149,-2.568 2.567,-2.568 h 9.905 c 1.419,0 2.568,1.15 2.568,2.568 0,1.419 -1.149,2.569 -2.568,2.569 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="rayo3"
					 d="m 4.273,61.677 c -0.888,0 -1.751,-0.46 -2.227,-1.284 -0.709,-1.228 -0.289,-2.799 0.94,-3.508 l 8.578,-4.953 c 1.229,-0.711 2.799,-0.288 3.508,0.941 0.709,1.228 0.289,2.799 -0.94,3.508 L 5.554,61.333 C 5.15,61.566 4.709,61.677 4.273,61.677 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="rayo4"
					 d="m 87.146,22.354 c -0.887,0 -1.751,-0.46 -2.227,-1.285 -0.709,-1.228 -0.288,-2.798 0.939,-3.508 l 8.578,-4.953 c 1.229,-0.708 2.799,-0.288 3.509,0.941 0.709,1.228 0.288,2.799 -0.94,3.508 l -8.577,4.953 c -0.404,0.233 -0.846,0.344 -1.282,0.344 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 id="rayo6"
					 d="m 95.72,61.769 c -0.436,0 -0.878,-0.111 -1.282,-0.345 L 85.86,56.472 c -1.228,-0.71 -1.648,-2.28 -0.939,-3.508 0.709,-1.229 2.28,-1.651 3.509,-0.94 l 8.577,4.952 c 1.229,0.709 1.649,2.279 0.94,3.508 -0.477,0.824 -1.34,1.285 -2.227,1.285 l 0,0 z"
					 inkscape:connector-curvature="0" />
				  <path
					 inkscape:connector-curvature="0"
					 id="relleno_bombilla"
					 d="M 41.970339,87.346492 C 41.566809,87.183665 41.440678,84.657 41.440678,76.73628 l 0,-10.396492 -5.826271,-6.02897 c -3.204449,-3.315932 -6.448199,-7.07206 -7.208332,-8.346948 -7.056453,-11.834998 -3.515754,-26.789215 8.128497,-34.330881 7.751279,-5.020293 19.022327,-5.01896 26.761365,0.0032 5.230211,3.394063 9.414648,9.162346 10.965326,15.115805 0.834072,3.20221 0.839212,9.054589 0.01081,12.307321 -1.336178,5.246522 -2.893331,7.563765 -9.830477,14.628995 l -6.475489,6.595056 0,10.414694 c 0,9.105954 -0.08423,10.447017 -0.670249,10.671894 -0.797454,0.306013 -14.56122,0.284971 -15.325514,-0.02343 l 0,5e-6 z m 13.782836,-2.497636 c 1.09835,-0.769318 1.231558,-2.37986 0.275881,-3.335538 -0.541326,-0.541326 -1.765187,-0.66586 -6.54377,-0.66586 -5.593719,0 -5.909802,0.04553 -6.53753,0.941741 -0.871768,1.244623 -0.832046,1.851937 0.187837,2.871818 0.759026,0.759025 1.412429,0.847458 6.26165,0.847458 4.214476,0 5.62287,-0.146166 6.355932,-0.659619 l 0,0 z m 0.433266,-7.475975 c 0.842815,-0.842817 0.604234,-2.766228 -0.433266,-3.492923 -0.722214,-0.505856 -2.098617,-0.659619 -5.904619,-0.659619 -2.729583,0 -5.43567,0.179754 -6.013527,0.399458 -1.39487,0.530326 -1.796183,1.911203 -0.936671,3.222983 0.669645,1.022008 0.777001,1.038576 6.730054,1.038576 4.140237,0 6.210035,-0.160483 6.558029,-0.508475 z m 0,-7.627118 c 0.279661,-0.279661 0.508474,-1.004238 0.508474,-1.61017 0,-1.946313 -0.574785,-2.118644 -7.066503,-2.118644 -6.011287,0 -6.054016,0.0068 -6.755021,1.076678 -0.564936,0.862204 -0.610896,1.284246 -0.230717,2.118644 0.473208,1.038581 0.49516,1.041966 6.755021,1.041966 4.319684,0 6.439008,-0.158737 6.788746,-0.508474 z"
					 style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.42372882;stroke-opacity:1" />
				</g>
			  </g>
			  <g
				 id="termometro"
				 transform="matrix(12.444394,0,0,10.411656,300.22122,455.33303)">
				<rect
				   style="fill:#ff0000;fill-opacity:1;stroke:#000000;stroke-width:0.1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
				   id="fijo"
				   width="1.7423953"
				   height="11.572904"
				   x="4.5949039"
				   y="1.8830394" />
				<rect
				   y="1.8830394"
				   x="4.5949039"
				   height="12"
				   width="1.7423953"
				   id="nivel"
				   style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" />
				<path
				   sodipodi:type="arc"
				   style="fill:#ff0000;fill-opacity:1;stroke:#000000;stroke-width:0.07560623;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
				   id="circulo_fijo"
				   sodipodi:cx="2.9661016"
				   sodipodi:cy="18.262712"
				   sodipodi:rx="1.1864407"
				   sodipodi:ry="1.2288135"
				   d="m 4.1525424,18.262712 c 0,0.678655 -0.5311876,1.228814 -1.1864408,1.228814 -0.6552531,0 -1.1864407,-0.550159 -1.1864407,-1.228814 0,-0.678654 0.5311876,-1.228813 1.1864407,-1.228813 0.6552532,0 1.1864408,0.550159 1.1864408,1.228813 z"
				   transform="matrix(1.8457642,0,0,1.7809639,-0.0509956,-17.186248)" />
			  </g>
			</g>
		  </g>
		</svg>
    </head>
    
    <body>
		
		<br>  <!--Salto de linea--> 
		<h3> Lampara </h3>  <!--Título de los botones-->
		<button id="ON">ON</button>  <!--Boton encendido de la lampara-->
		<button id="OFF">OFF</button>  <!--Boton apagado de la lampara-->
		
		<!--Importamos la libreria Raphael.js-->
		<script src={{=URL('static','js/raphael-min.js')}}> </script>
		
		<script>
		  
		  // Desde el principio pongo los rayos de la lámpara de color blanco
		  jQuery("#rayo1").attr('style','fill:white');
		  jQuery("#rayo2").attr('style','fill:white');
		  jQuery("#rayo3").attr('style','fill:white');
		  jQuery("#rayo4").attr('style','fill:white');
		  jQuery("#rayo5").attr('style','fill:white');
		  jQuery("#rayo6").attr('style','fill:white');
		  
		  // Creo las variables
		  var n='';
		  var datos={};
		  var j;
		  
		  // Funcion ready cuando se carge la pagina se ejecuta el codigo
		  jQuery(document).ready(function()
		  {
			// Creo el temporizador para temporizar la funcion temp_post que se realice cada 100 ms
		    temporizador = window.setInterval(temp_post, 100);
		    
		    // Funcion click al boton de encender la lampara
		    jQuery("#ON").click(function() 
		    {
			  // Pongo la variable n a 1 que es lo que valdra la clave Valor dentro del diccionario datos
			  n=1;
			  datos={'Valor': n};
			  
			  // Pongo la variable j a 0
			  j=0;
			  
			  // Cambio el color del relleno de la bombilla y de los rayos a amarillo
			  jQuery("#relleno_bombilla").attr('style','fill:yellow'); 
			  jQuery("#rayo1").attr('style','fill:yellow'); 
			  jQuery("#rayo2").attr('style','fill:yellow'); 
			  jQuery("#rayo3").attr('style','fill:yellow'); 
			  jQuery("#rayo4").attr('style','fill:yellow'); 
			  jQuery("#rayo5").attr('style','fill:yellow'); 
			  jQuery("#rayo6").attr('style','fill:yellow'); 
		    });  
		    
		    // Funcion click al boton de encender la lampara
		    jQuery("#OFF").click(function() 
		    {
			  // Pongo la variable n a 0 que es lo que valdra la clave Valor dentro del diccionario datos
			  n=0;
			  datos={'Valor': n};
			  
			  // Pongo la variable j a 0
			  j=0;
			  
			  // Cambio el color del relleno de la bombilla y de los rayos a blanco
              jQuery("#relleno_bombilla").attr('style','fill:white'); 
			  jQuery("#rayo1").attr('style','fill:white');
			  jQuery("#rayo2").attr('style','fill:white');
			  jQuery("#rayo3").attr('style','fill:white');
			  jQuery("#rayo4").attr('style','fill:white');
			  jQuery("#rayo5").attr('style','fill:white');
			  jQuery("#rayo6").attr('style','fill:white');
		    }); 
		    
		    // Funcion temporizada
		    function temp_post()
		    {
			  // Si hemos pulsado cualquiera de los 2 botones, j=0 y se ejecuta el siguiente codigo
			  if (j==0)
			  {
		       // Post a la funcion recibe_datos, y le manda la variable datos, que es un diccionario
		       jQuery.post("{{=URL('default','recibe_datos.json')}}",datos, {contentType: 'application/json'})
		       
		       // Cuando el post se a realizado correctamente se ejecuta la funcion .success, que recoje el return de la funcion recibe_datos
		       .success(function(dic)
		       {
				 // Imprime por consola lo que viene de la funcion recibe_datos
				 window.console.log(dic);
				 
				 // Saca el valor de la clave "nivel" y cambia la altura del elemento con id "#nivel"
			     jQuery("#nivel").attr('height',dic["nivel"]);  
	
				 // Si el valor de la clave "puerta" = 1 la anchura del elemento con id "#puerta" es 2
  				 if(dic["puerta"]==1)
				 {
				   jQuery("#puerta").attr('width',2);
				 }
				 
				 // Si el valor de la clave "puerta" = 0 la anchura del elemento con id "#puerta" es 23
				 if(dic["puerta"]==0)
				 {
				   jQuery("#puerta").attr('width',23);
				 }		
		       });
		      }
		      
		      // Si no hemos pulsado cualquiera de los 2 botones, j=1 y se ejecuta el siguiente codigo
		      else
		      {
				// Post a la funcion recibe_datos, y no manda nada
			    jQuery.post("{{=URL('default','recibe_datos.json')}}", {contentType: 'application/json'})
		        
		        // Cuando el post se a realizado correctamente se ejecuta la funcion .success, que recoje el return de la funcion recibe_datos 
		        .success(function(dic)
		        {
			      // Imprime por consola lo que viene de la funcion recibe_datos
			      window.console.log(dic);
			      jQuery("#nivel").attr('height',dic["nivel"]);  // de 0 a 12
	
				  // Si el valor de la clave "puerta" = 1 la anchura del elemento con id "#puerta" es 2
  				  if(dic["puerta"]==1)
				  {
				    jQuery("#puerta").attr('width',2);
			 	  }
			 	  
			 	  // Si el valor de la clave "puerta" = 0 la anchura del elemento con id "#puerta" es 23
				  if(dic["puerta"]==0)
				  {
				    jQuery("#puerta").attr('width',23);
				  }		
		        });
			  }
			 // Pongo la variable j a 1
		     j=1;
		    } 
	   });  
		</script>
    </body>
</html>

